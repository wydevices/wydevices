# -*- coding: utf-8 -*- 
#
# Description:
#
# Version Decorator Definitions
#
#
#
# Changes:
#
# 2011-10-02
# Initial Commit
#
# 2011-10-04
# Remove serial_number function (No more need)
# Add Wydev version function
#
# 2012-01-02
# Add Wydev revision function
#
#
# Copyright 2010-2012, WyDev Team.
# Author: Polo35 (polo35580@hotmail.fr)
#
# Licenced under Academic Free License version 3.0
# Review WyGui README & LICENSE files for further details.


from __future__ import absolute_import

from peewee.debug import log



# Return the Wybox's version.
def wyplay_version():
	try:
		ver_file = open('/etc/wybox-release', 'r')
		version = ver_file.readline().strip()
		ver_file.close()
	except IOError:
		log.error('Unable to retrieve Wybox version.')
		version = None
	if not version:
		version = 'N/A'
	return version



# Return the Wybox's version.
def wybox_version():
	try:
		ver_file = open('/etc/wybox-release', 'r')
		version = ver_file.readline().strip()
		ver_file.close()
	except IOError:
		log.error('Unable to retrieve Wybox version.')
		version = None
	if not version:
		version = 'N/A'
	return version



# Return the Wydev's version.
def wydev_version():
	try:
		ver_file = open('/wymedia/etc/wydev-mod-version', 'r')
		version = ver_file.readline().strip()
		ver_file.close()
	except IOError:
		log.error('Unable to retrieve Wydev version.')
		version = None
	if not version:
		version = 'N/A'
	return version



# Return the Wydev's revision.
def wydev_revision():
	try:
		ver_file = open('/wymedia/usr/etc/wydev-mod-updaterelease', 'r')
		version = ver_file.readline().strip()
		ver_file.close()
	except IOError:
		log.error('Unable to retrieve Wydev version.')
		version = None
	if not version:
		version = 'N/A'
	return version



# Remove all the unnecessary 0-padding from a version string for Wyplay version
# Remove 'wydev-mod' for Wydev version
def format_version(version):
	if 'wydev-mod' in version:
		return version.replace('wydev-mod-v', '')
	elif 'r' in version:
		return version.replace('r', '')
	else:
		return '.'.join((i.lstrip('0') for i in version.split('.')))
