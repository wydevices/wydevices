# -*- coding: utf-8 -*- 
#
# Description:
#
#  Definition of Generic EvendHandler for Menus and Navigators
#
#
#
# Changes:
#
# 2014-03-24
# Initial Commit
#
#
# Copyright 2010-2014, WyDev Team.
# Author: Polo35 (polo35580@hotmail.fr)
#
# Licenced under Academic Free License version 3.0
# Review WyGui README & LICENSE files for further details.


from __future__ import absolute_import

from pygui.eventmanager import EventDispatcher
from pygui.shared import pygui_globs
from peewee.messages import send as louie_send
import pygui.config as config


# Generic EvendHandler for Menus and Navigators
class MenuEventHandler(EventDispatcher):

	def event_DEFAULT(self, event):
		return False

	def _move(self, val):
		ret = self.player.select(val)
		if ret:
			louie_send('event_up' if val < 0 else 'event_down', sender=self.player)
		else:
			louie_send('rebound_up' if val < 0 else 'rebound_down', sender=self.player)
		return True

	def event_up(self, event):
		return self._move(-event.arg['count'])

	def event_down(self, event):
		return self._move(event.arg['count'])

	def event_wheel_rwd(self, event):
		return self._move(-event.arg['count'] ** 2)

	def event_wheel_fwd(self, event):
		return self._move(event.arg['count'] ** 2)

	def event_toggle_menu(self, event):
		pygui_globs['menustack'].toggle()
		return True

	def event_select(self, event, list_name='main_list'):
		sel = self.player.get_item_list(list_name).selected
		if sel:
			sel.execute()
		return True

	event_right = event_select
	
	def event_left(self, event):
		pygui_globs['menustack'].back_one_menu()
		return True

	def event_mouse(self, event):
		arg = event.arg
		self.player._cursor.set_absolute(arg["x"], arg["y"], self.player)
