# -*- coding: utf-8 -*- 
#
# Description:
#
# Picasa Config Class Definition
# Save Picasa users and password to "/wymedia/usr/etc/picasa.conf" file
#
#
# Changes:
#
# 2012-01-24
# Initial commit.
#
#
# Copyright 2010-2014, WyDev Team.
# Author: Polo35 (polo35580@hotmail.fr)
#
# Licenced under Academic Free License version 3.0
# Review WyGui README & LICENSE files for further details.


import ConfigParser



class PicasaConfig(object):

	def __init__(self):
		self.config = ConfigParser.ConfigParser()
		self.config.optionxform = str
		self.config.read('/wymedia/usr/etc/picasa.conf')

	def AddPrivateUser(self, username, password):
		if not self.config.has_section('Picasa Private Users'):
			self.config.add_section('Picasa Private Users')
		if not username in self.GetPrivateUsers():
			self.config.set('Picasa Private Users', username, password)
			configfile = open('/wymedia/usr/etc/picasa.conf', 'wb')
			self.config.write(configfile)
			configfile.close()
		else:
			self.config.remove_option('Picasa Private Users', username)
			self.config.set('Picasa Private Users', username, password)
			configfile = open('/wymedia/usr/etc/picasa.conf', 'wb')
			self.config.write(configfile)
			configfile.close()

	def DelPrivateUser(self, username):
		try:
			self.config.remove_option('Picasa Private Users', username)
			configfile = open('/wymedia/usr/etc/picasa.conf', 'wb')
			self.config.write(configfile)
			configfile.close()
		except:
			pass

	def GetPrivateUsers(self):
		try:
			self.config.read('/wymedia/usr/etc/picasa.conf')
			users = self.config.options('Picasa Private Users')
		except:
			users = []
		return users

	def GetPrivatePassword(self, username):
		try:
			self.config.read('/wymedia/usr/etc/picasa.conf')
			password = self.config.get('Picasa Private Users', username)
		except:
			password = ''
		return password

	def AddPublicUser(self, username):
		if not self.config.has_section('Picasa Public Users'):
			self.config.add_section('Picasa Public Users')
		if not username in self.GetPublicUsers():
			self.config.set('Picasa Public Users', username, 0)
			configfile = open('/wymedia/usr/etc/picasa.conf', 'wb')
			self.config.write(configfile)
			configfile.close()

	def DelPublicUser(self, username):
		try:
			self.config.remove_option('Picasa Public Users', username)
			configfile = open('/wymedia/usr/etc/picasa.conf', 'wb')
			self.config.write(configfile)
			configfile.close()
		except:
			pass

	def GetPublicUsers(self):
		try:
			self.config.read('/wymedia/usr/etc/picasa.conf')
			users = self.config.options('Picasa Public Users')
		except:
			users = []
		return users
