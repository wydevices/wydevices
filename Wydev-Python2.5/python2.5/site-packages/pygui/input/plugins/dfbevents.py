# -*- coding: utf-8 -*- 
#
# Description:
#
# DfbEvents Input Plugin Class Definition
#
#
#
# Changes:
#
# 2014-04-03
# Initial Commit
#
#
# Copyright 2010-2014, WyDev Team.
# Author: Polo35 (polo35580@hotmail.fr)
#
# Licenced under Academic Free License version 3.0
# Review WyGui README & LICENSE files for further details.


from __future__ import absolute_import

from peewee.debug import log
from pygui.input import DIRECTFB_MAP
from pygui.shared import pygui_globs
from peewee.notifier import sched


class PluginInterface(object):
	
	def __init__(self, post_key):
		self.post_key = post_key
		self.plugin_name = 'DirectFB Input'
		display = pygui_globs['display']
		display.register_event(self.handle)
		self.kbmap_get = DIRECTFB_MAP.get
		return None

	def handle(self, key, keypress, ts):
		try:
			mapped = self.kbmap_get(key.upper())
			mapped.post(dict(count=1, timeout=ts + 0.40000000000000002))
		except IndexError:
			log.debug('Key %s not recognised.' % key)
		return None
