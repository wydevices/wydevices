# -*- coding: utf-8 -*- 
#
# Description:
#
# Common Jobs Definition
#
#
#
# Changes:
#
# 2014-04-03
# Initial Commit
#
#
# Copyright 2010-2014, WyDev Team.
# Author: Polo35 (polo35580@hotmail.fr)
#
# Licenced under Academic Free License version 3.0
# Review WyGui README & LICENSE files for further details.


from __future__ import absolute_import

from pygui.window import LoadingWindow
from pygui.item.containers import ActionContainer
from pygui.config import user_config
from pygui.markerlist import markerlists


def push_thumbnail_menu(context, stack):
	loader = LoadingWindow()
	loader.show()
	from pygui.menu.menu import ThumbnailNavigator
	from copy import copy
	thumbnail_menu = ThumbnailNavigator('thumbnail_menu', folder=copy(context['parent']), universe=context['menu'].universe, type='%s_thumbnail' % context['menu'].type)
	try:
		thumbnail_menu.select(context['selected'])
	except ValueError:
		thumbnail_menu.select(thumbnail_menu.choices[0])
	stack.back_to_menu(context['menu'])
	context['menu'].stop()
	stack.push_menu(thumbnail_menu)
	loader.hide()
	return None

def push_search_menu(context, stack):
	from pygui.menu.menu import SearchMenu
	stack.back_to_menu(context['menu'])
	context['menu'].stop()
	search_menu = SearchMenu(universe=context['menu'].universe)
	return None

# Set val in user_config in order to show or not hidden files
def display_hidden_items(val, context, stack):
	user_config['security']['show_hidden'] = val
	user_config.save()
	markerlists().clear_all_markerlists()
	stack.back_to_menu(context['menu'])
	context['menu'].reload_func()
	return None

def switch_to_children_mode(context, stack):
	user_config['security']['parent_mode'] = False
	user_config.save()
	markerlists().clear_all_markerlists()
	stack.back_to_menu(context['menu'])
	context['menu'].reload_func()
	return None

def switch_to_parent_mode(context, stack):
	from pygui.menu.menu.parameters import SecretCodeCheckMenu
	def good_code():
		user_config['security']['parent_mode'] = True
		user_config.save()
		stack.back_to_menu(context['menu'])
		context['menu'].reload_func()
		return None

	def display_qa():
		from pygui.menu.menu.security import QuestionAnswerCheckLauncher
		QuestionAnswerCheckLauncher(good_code)
		return None

	pin_menu = SecretCodeCheckMenu(_('Secret code'), action=good_code, cancel_action=display_qa)
	pin_menu.show()
	return None

def rotate_left(context):
	context['menu'].rotate(-1)
	return None

def rotate_right(context):
	context['menu'].rotate(1)
	return None

from pygui.facilities import l10n
