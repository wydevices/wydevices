# -*- coding: utf-8 -*- 
#
# Description:
#
# WyRecord Tools Class Definition
#
#
#
# Changes:
#
# 2014-03-26
# Initial Commit
#
#
# Copyright 2010-2014, WyDev Team.
# Author: Polo35 (polo35580@hotmail.fr)
#
# Licenced under Academic Free License version 3.0
# Review WyGui README & LICENSE files for further details.


from peewee import notifier
from logger import log
from config import *
import os


# Internal api for one shot timer.
#
# The goal is to reduce the dependency whith peewee
class WyrecordOnShotTimer(object):

	def __init__(self, callback, *args, **kwargs):
		self.callback = callback
		self.args = args
		self.kwargs = kwargs
		self.task = None
		return None

	def start(self, delay):
		self.stop()
		self.task = notifier.Task(self.callback, *self.args, **self.kwargs)
		self.task.start(delay=delay, consider_idle=True)
		return None

	def stop(self):
		try:
			if self.task:
				self.task.stop()
		except ValueError:
			pass
		return None

	def set_args(self, *args, **kwargs):
		self.args = args
		self.kwargs = kwargs
		return None



def removeFolder(folder_path):
	try:
		files = os.listdir(folder_path)
		for file in files:
			file_path = os.path.join(folder_path, file)
			if os.path.isdir(file_path):
				removeFolder(file_path)
			else:
				os.remove(file_path)
		os.rmdir(folder_path)
	except:
		log.debug('removeFolder failed')
	return None
